{
  "version": "2.0",
  "metadata": {
    "name": "åç«¯-å‰ç«¯-ä»£ç å®¡æŸ¥åä½œæµç¨‹",
    "description": "ç”¨æˆ·è¾“å…¥ -> åç«¯å¼€å‘ -> å‰ç«¯é›†æˆ -> ä»£ç å®¡æŸ¥çš„å®Œæ•´å¼€å‘æµç¨‹",
    "namespace": "dev_workflow",
    "created_at": "2025-01-25T10:00:00Z"
  },
  "roles": {
    "backend": {
      "name": "åç«¯å·¥ç¨‹å¸ˆ",
      "instance_pattern": "*backend*",
      "responsibilities": ["APIå¼€å‘", "ä¸šåŠ¡é€»è¾‘", "æ•°æ®åº“è®¾è®¡"],
      "tools": ["git", "database", "postman"]
    },
    "frontend": {
      "name": "å‰ç«¯å·¥ç¨‹å¸ˆ", 
      "instance_pattern": "*frontend*",
      "responsibilities": ["UIå®ç°", "æ¥å£é›†æˆ", "ç”¨æˆ·äº¤äº’"],
      "tools": ["git", "npm", "webpack"]
    },
    "code_reviewer": {
      "name": "ä»£ç å®¡æŸ¥å·¥ç¨‹å¸ˆ",
      "instance_pattern": "*review*",
      "responsibilities": ["ä»£ç è´¨é‡å®¡æŸ¥", "å®‰å…¨æ£€æŸ¥", "æœ€ä½³å®è·µéªŒè¯", "åˆè§„æ€§æ£€æŸ¥"],
      "tools": ["git", "sonarqube", "eslint", "code_review_tools"]
    }
  },
  "nodes": {
    "start": {
      "id": "start",
      "type": "start",
      "title": "ç”¨æˆ·éœ€æ±‚è¾“å…¥",
      "description": "ç”¨æˆ·å‘åç«¯è¾“å…¥å¼€å‘éœ€æ±‚"
    },
    "backend_development": {
      "id": "backend_development",
      "type": "task",
      "title": "åç«¯å¼€å‘",
      "owner": "backend",
      "description": "æ ¹æ®ç”¨æˆ·éœ€æ±‚å¼€å‘åç«¯APIå’Œä¸šåŠ¡é€»è¾‘",
      "estimated_time": "4-8h",
      "deliverables": [
        "APIæ¥å£å®ç°",
        "æ¥å£æ–‡æ¡£",
        "å•å…ƒæµ‹è¯•",
        "æµ‹è¯•æ•°æ®"
      ],
      "completion_trigger": {
        "action": "notify_next",
        "target": "frontend",
        "message_template": "ğŸš€ **æ¥è‡ªåç«¯å·¥ç¨‹å¸ˆ**: åç«¯å¼€å‘å®Œæˆï¼\n\nğŸ“‹ **å®Œæˆå†…å®¹**ï¼š\n{deliverables}\n\nğŸ“– **æ¥å£æ–‡æ¡£**: å·²æ›´æ–°\nğŸ”— **æµ‹è¯•åœ°å€**: {test_url}\nğŸ§ª **æµ‹è¯•æ•°æ®**: å·²å‡†å¤‡\n\nâœ¨ **è¯·å¼€å§‹å‰ç«¯é›†æˆå¼€å‘**ï¼Œå¦‚æœ‰é—®é¢˜éšæ—¶æ²Ÿé€šï¼\n\n---\nğŸ’¡ å®Œæˆåå°†è¿›è¡Œä»£ç å®¡æŸ¥",
        "auto_send": true,
        "sender_info": {
          "role": "backend",
          "task_id": "backend_development"
        }
      }
    },
    "frontend_integration": {
      "id": "frontend_integration",
      "type": "task", 
      "title": "å‰ç«¯é›†æˆå¼€å‘",
      "owner": "frontend",
      "description": "é›†æˆåç«¯APIï¼Œå®Œæˆå‰ç«¯åŠŸèƒ½å®ç°",
      "estimated_time": "3-6h",
      "dependencies": ["backend_development"],
      "deliverables": [
        "å‰ç«¯é¡µé¢å®ç°",
        "APIæ¥å£é›†æˆ",
        "å‰ç«¯æµ‹è¯•",
        "ç”¨æˆ·ç•Œé¢ä¼˜åŒ–"
      ],
      "completion_trigger": {
        "action": "notify_next",
        "target": "code_reviewer",
        "message_template": "âœ… **æ¥è‡ªå‰ç«¯å·¥ç¨‹å¸ˆ**: å‰åç«¯é›†æˆå®Œæˆï¼Œè¯·è¿›è¡Œä»£ç å®¡æŸ¥ï¼\n\nğŸ“¦ **äº¤ä»˜å†…å®¹**ï¼š\n- åç«¯: {backend_deliverables}\n- å‰ç«¯: {frontend_deliverables}\n\nğŸ§ª **æµ‹è¯•çŠ¶æ€**: å‰åç«¯è”è°ƒé€šè¿‡\nğŸ¯ **åŠŸèƒ½éªŒè¯**: ç”¨æˆ·éœ€æ±‚å·²å®ç°\n\nğŸ” **è¯·è¿›è¡Œä»£ç è´¨é‡å®¡æŸ¥**ï¼\n\n---\nğŸ“ **å®¡æŸ¥é‡ç‚¹**: \n- ä»£ç è§„èŒƒ\n- å®‰å…¨æ€§æ£€æŸ¥\n- æ€§èƒ½ä¼˜åŒ–\n- æœ€ä½³å®è·µéªŒè¯",
        "auto_send": true,
        "sender_info": {
          "role": "frontend", 
          "task_id": "frontend_integration"
        }
      }
    },
    "code_review": {
      "id": "code_review",
      "type": "task",
      "title": "ä»£ç å®¡æŸ¥",
      "owner": "code_reviewer", 
      "description": "å¯¹å‰åç«¯ä»£ç è¿›è¡Œè´¨é‡å®¡æŸ¥ï¼Œç¡®ä¿ä»£ç è§„èŒƒå’Œå®‰å…¨æ€§",
      "estimated_time": "1-2h",
      "dependencies": ["frontend_integration"],
      "deliverables": [
        "ä»£ç å®¡æŸ¥æŠ¥å‘Š",
        "å®‰å…¨æ£€æŸ¥æ¸…å•",
        "æ€§èƒ½ä¼˜åŒ–å»ºè®®",
        "ä»£ç è§„èŒƒè¯„ä¼°",
        "å®¡æŸ¥æ‰¹å‡†çŠ¶æ€"
      ],
      "completion_trigger": {
        "action": "broadcast_all",
        "message_template": "ğŸ¯ **æ¥è‡ªä»£ç å®¡æŸ¥å·¥ç¨‹å¸ˆ**: ä»£ç å®¡æŸ¥å®Œæˆï¼\n\nğŸ“‹ **å®¡æŸ¥ç»“æœ**ï¼š\nâœ… **ä»£ç è´¨é‡**: {code_quality_score}\nâœ… **å®‰å…¨æ£€æŸ¥**: {security_status}\nâœ… **æ€§èƒ½è¯„ä¼°**: {performance_rating}\n\nğŸ“Š **è¯¦ç»†è¯„ä¼°**ï¼š\n- ä»£ç è§„èŒƒ: {code_standards}\n- æœ€ä½³å®è·µ: {best_practices}\n- æµ‹è¯•è¦†ç›–ç‡: {test_coverage}\n\nğŸ’¡ **æ”¹è¿›å»ºè®®**ï¼š\n{improvement_suggestions}\n\nğŸš€ **å®¡æŸ¥çŠ¶æ€**: é€šè¿‡å®¡æŸ¥ï¼Œå¯ä»¥è¿›è¡Œåç»­éƒ¨ç½²ï¼\n\næ„Ÿè°¢å›¢é˜Ÿçš„å‡ºè‰²å·¥ä½œï¼",
        "auto_send": true,
        "sender_info": {
          "role": "code_reviewer",
          "task_id": "code_review"
        }
      }
    },
    "end": {
      "id": "end",
      "type": "end",
      "title": "å¼€å‘æµç¨‹å®Œæˆ"
    }
  },
  "edges": [
    {"from": "start", "to": "backend_development"},
    {"from": "backend_development", "to": "frontend_integration"},
    {"from": "frontend_integration", "to": "code_review"},
    {"from": "code_review", "to": "end"}
  ],
  "dag_tracking": {
    "current_edge": null,
    "completed_edges": [],
    "edge_transitions": {
      "user_input_to_backend": {
        "trigger": "user_message_detected",
        "from_node": "start",
        "to_node": "backend_development"
      },
      "backend_to_frontend": {
        "trigger": "backend_completion_message",
        "from_node": "backend_development", 
        "to_node": "frontend_integration"
      },
      "frontend_to_review": {
        "trigger": "frontend_completion_message",
        "from_node": "frontend_integration",
        "to_node": "code_review"
      }
    }
  },
  "message_routing": {
    "sender_detection": {
      "enabled": true,
      "methods": ["instance_pattern", "message_signature", "tmux_session"]
    },
    "message_templates": {
      "task_completion": "ğŸ”„ **DAGæ›´æ–°**: {sender_role} -> {target_role}\nğŸ“ **å½“å‰èŠ‚ç‚¹**: {current_node}\nâ­ï¸ **ä¸‹ä¸€æ­¥**: {next_node}"
    }
  },
  "auto_triggers": {
    "task_complete": {
      "enabled": true,
      "command_template": "qq send {target_instance} \"{message}\" --from {sender_instance}"
    },
    "dag_progress_update": {
      "enabled": true,
      "command_template": "qq workflow update-edge {current_edge} --status completed"
    }
  },
  "review_criteria": {
    "code_quality": {
      "standards": ["ä»£ç è§„èŒƒ", "å‘½åè§„èŒƒ", "æ³¨é‡Šå®Œæ•´æ€§"],
      "security": ["SQLæ³¨å…¥é˜²æŠ¤", "XSSé˜²æŠ¤", "è®¤è¯æˆæƒ"],
      "performance": ["æŸ¥è¯¢ä¼˜åŒ–", "ç¼“å­˜ç­–ç•¥", "èµ„æºç®¡ç†"],
      "testing": ["å•å…ƒæµ‹è¯•", "é›†æˆæµ‹è¯•", "è¦†ç›–ç‡è¦æ±‚"]
    },
    "approval_conditions": {
      "min_code_quality_score": 80,
      "security_issues_allowed": 0,
      "test_coverage_required": 70
    }
  }
}
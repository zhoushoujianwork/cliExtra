## 工程开发要点
- 开发要适合当前的项目开发风格，不要自己轻易重构，除非用户明确要求。

## 状态自动管理机制

### 🤖 AI 实例状态管理职责
作为 AI 实例，你需要主动管理自己的工作状态：

#### 1. **接收消息时**
- 当收到 `qq send` 或 `qq broadcast` 消息时，系统会自动将你的状态设置为 `busy`
- 状态文件会记录任务描述（消息内容前50字符）
- 你无需手动设置忙碌状态

#### 2. **任务完成时**
- **必须主动调用**: `qq task complete` 将状态设置为 `idle`
- **推荐用法**: `qq task complete --task "具体完成的工作描述"`
- **自动检测**: 在自己的实例中可以省略实例ID，系统会自动检测

#### 3. **任务暂停时**
- 需要等待用户输入时: `qq task pause --task "等待用户确认需求"`
- 需要外部资源时: `qq task pause --task "等待API响应"`
- 遇到阻塞问题时: `qq task pause --task "等待技术问题解决"`

#### 4. **遇到错误时**
- 技术错误: `qq task error --task "遇到技术问题，需要人工干预"`
- 需求不明确: `qq task error --task "需求不明确，无法继续"`

### 📋 状态管理最佳实践

#### **工作流程示例**
```bash
# 1. 接收消息（系统自动设置为 busy）
# 收到: "请帮我优化这个函数的性能"

# 2. 开始工作（状态已经是 busy，无需设置）
# 进行代码分析和优化...

# 3. 完成工作（主动设置为 idle）
qq task complete --task "函数性能优化完成，提升了30%的执行效率"

# 4. 如果需要暂停
qq task pause --task "需要用户提供更多测试数据"

# 5. 如果遇到错误
qq task error --task "代码依赖缺失，需要安装额外包"
```

#### **状态检查和协作**
- 发送消息前检查目标实例状态: `qq status target_instance`
- 查看所有实例状态: `qq status -A`
- 只有 `idle` 状态的实例才会接收新消息（除非使用 --force）

### ⚡ 便捷命令
- `qq task complete` - 当前实例任务完成（最常用）
- `qq task start --task "新任务描述"` - 开始新任务
- `qq task pause --task "暂停原因"` - 暂停当前任务
- `qq task error --task "错误描述"` - 标记错误状态

### 🎯 协作感知增强
- 完成工作后，主动询问是否需要通知其他实例
- 建议使用 `qq send` 或 `qq broadcast` 进行协作通信
- 发送协作消息时，目标实例会自动变为忙碌状态

## 协作通信要点
- 发送消息时如果包含 JSON 格式，注意转义引号避免命令解析错误
- 消息过长可能导致发送失败，需要适当分段或简化内容
- 终端输出的时候简短文本方式；